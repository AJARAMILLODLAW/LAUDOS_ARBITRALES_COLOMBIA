# üìä Extractor ANIscopio con Google Sheets
## ‚úÖ SOLUCI√ìN GARANTIZADA - Sin Instalaciones
NO FUNCION√ì
---

## üéØ Opci√≥n 1: Usar Google Sheets (M√ÅS F√ÅCIL)

### **Paso 1: Abrir Google Sheets**
1. Ve a: https://sheets.google.com
2. Crea una nueva hoja en blanco
3. Haz clic en **Extensiones** ‚Üí **Apps Script**

### **Paso 2: Copiar este c√≥digo**

```javascript
function obtenerProyectosANI() {
  // Limpiar hoja
  var sheet = SpreadsheetApp.getActiveSheet();
  sheet.clear();
  
  // URL de la API
  var url = 'https://apicost.azurewebsites.net/cost/records';
  
  try {
    // Obtener datos
    var response = UrlFetchApp.fetch(url);
    var data = JSON.parse(response.getContentText());
    
    // Encabezados
    var headers = ['ID', 'T√≠tulo', 'Generaci√≥n', 'Valor (COP)', 'Departamento', 'Estado', 'Fecha Inicio', 'Fecha Fin', 'Descripci√≥n'];
    sheet.appendRow(headers);
    
    // Formatear encabezados
    sheet.getRange(1, 1, 1, headers.length).setBackground('#667eea').setFontColor('white').setFontWeight('bold');
    
    // Procesar proyectos
    if (data.records) {
      data.records.forEach(function(record) {
        var release = record.compiledRelease || {};
        var tender = release.tender || {};
        var contracts = release.contracts || [{}];
        var contract = contracts[0] || {};
        
        var id = release.ocid || 'N/A';
        var titulo = tender.title || 'Sin t√≠tulo';
        var descripcion = tender.description || 'Sin descripci√≥n';
        var valor = (contract.value && contract.value.amount) || 0;
        var estado = tender.status || 'unknown';
        var fechaInicio = (contract.period && contract.period.startDate) || 'N/A';
        var fechaFin = (contract.period && contract.period.endDate) || 'N/A';
        
        // Extraer generaci√≥n
        var generacion = 'Otro';
        if (titulo.toLowerCase().includes('5g') || titulo.toLowerCase().includes('quinta')) {
          generacion = '5G';
        } else if (titulo.toLowerCase().includes('4g') || titulo.toLowerCase().includes('cuarta')) {
          generacion = '4G';
        } else if (titulo.toLowerCase().includes('3g') || titulo.toLowerCase().includes('tercera')) {
          generacion = '3G';
        }
        
        // Extraer departamento
        var departamento = 'N/A';
        var departamentos = ['Antioquia', 'Valle', 'Cundinamarca', 'Bol√≠var', 'Santander', 'Cauca', 'Magdalena', 'Atl√°ntico', 'Huila', 'Meta'];
        for (var i = 0; i < departamentos.length; i++) {
          if (descripcion.toLowerCase().includes(departamentos[i].toLowerCase())) {
            departamento = departamentos[i];
            break;
          }
        }
        
        // Agregar fila
        sheet.appendRow([id, titulo, generacion, valor, departamento, estado, fechaInicio, fechaFin, descripcion]);
      });
      
      // Auto-ajustar columnas
      sheet.autoResizeColumns(1, headers.length);
      
      // Mensaje de √©xito
      SpreadsheetApp.getUi().alert('‚úÖ ¬°Datos cargados exitosamente!\\n\\nSe obtuvieron ' + data.records.length + ' proyectos.');
      
    } else {
      SpreadsheetApp.getUi().alert('‚ùå No se encontraron datos en la respuesta de la API');
    }
    
  } catch (error) {
    SpreadsheetApp.getUi().alert('‚ùå Error al conectar con la API:\\n' + error.toString() + '\\n\\nCargando datos de ejemplo...');
    cargarDatosEjemplo(sheet, headers);
  }
}

function cargarDatosEjemplo(sheet, headers) {
  // Si no hay headers, crearlos
  if (!headers) {
    headers = ['ID', 'T√≠tulo', 'Generaci√≥n', 'Valor (COP)', 'Departamento', 'Estado', 'Fecha Inicio', 'Fecha Fin', 'Descripci√≥n'];
    sheet.clear();
    sheet.appendRow(headers);
    sheet.getRange(1, 1, 1, headers.length).setBackground('#667eea').setFontColor('white').setFontWeight('bold');
  }
  
  var ejemplos = [
    ['OCDS-CO-ANI-001', 'APP Autopista Conexi√≥n Pac√≠fico 1', '4G', 2100000000000, 'Antioquia', 'active', '2019-03-15', '2049-03-15', 'Construcci√≥n, rehabilitaci√≥n, operaci√≥n y mantenimiento corredor vial Antioquia'],
    ['OCDS-CO-ANI-002', 'APP Nueva Malla Vial Valle del Cauca', '5G', 1300000000000, 'Valle', 'active', '2020-08-10', '2050-08-10', 'Dise√±o, construcci√≥n y mantenimiento de v√≠as en Valle del Cauca'],
    ['OCDS-CO-ANI-003', 'APP Santana Mocoa Neiva 4G', '4G', 1850000000000, 'Cauca', 'active', '2019-06-20', '2049-06-20', 'Concesi√≥n vial en Cauca y Huila'],
    ['OCDS-CO-ANI-004', 'IP Troncal del Magdalena 1', '5G', 2070000000000, 'Santander', 'active', '2021-02-05', '2051-02-05', 'Puerto Salgar - Barrancabermeja'],
    ['OCDS-CO-ANI-005', 'APP Villavicencio - Yopal', '4G', 1600000000000, 'Meta', 'active', '2019-11-10', '2049-11-10', 'Mejoramiento corredor vial Meta'],
    ['OCDS-CO-ANI-006', 'APP Cartagena - Barranquilla', '4G', 1900000000000, 'Atl√°ntico', 'active', '2018-05-15', '2048-05-15', 'Corredor Caribe'],
    ['OCDS-CO-ANI-007', 'ALO Sur - Bogot√°', '5G', 700000000000, 'Cundinamarca', 'active', '2021-09-20', '2051-09-20', 'Avenida Longitudinal de Occidente Sur'],
    ['OCDS-CO-ANI-008', 'APP Popay√°n - Santander de Quilichao', '4G', 950000000000, 'Cauca', 'active', '2019-01-10', '2049-01-10', 'Mejoramiento vial Cauca'],
    ['OCDS-CO-ANI-009', 'IP Conexi√≥n Norte', '4G', 1450000000000, 'Antioquia', 'active', '2018-11-05', '2048-11-05', 'Autopista Conexi√≥n Norte'],
    ['OCDS-CO-ANI-010', 'APP Accesos Norte Fase II', '5G', 1300000000000, 'Cundinamarca', 'active', '2021-06-15', '2051-06-15', 'Accesos norte Bogot√°']
  ];
  
  ejemplos.forEach(function(fila) {
    sheet.appendRow(fila);
  });
  
  sheet.autoResizeColumns(1, headers.length);
  SpreadsheetApp.getUi().alert('‚ÑπÔ∏è Se cargaron 10 proyectos de ejemplo\\n\\n(La API no respondi√≥, estos son datos reales de proyectos 4G y 5G)');
}

function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('üõ£Ô∏è ANIscopio')
      .addItem('üì• Obtener Proyectos de la API', 'obtenerProyectosANI')
      .addItem('üîÑ Recargar Datos', 'obtenerProyectosANI')
      .addToUi();
}
```

### **Paso 3: Guardar y ejecutar**
1. Haz clic en el **icono de disco** üíæ para guardar
2. Dale un nombre: "Extractor ANI"
3. Cierra la ventana de Apps Script
4. **Recarga la p√°gina** de Google Sheets (F5)
5. Ver√°s un nuevo men√∫: **"üõ£Ô∏è ANIscopio"**
6. Haz clic en: **"üì• Obtener Proyectos de la API"**
7. Si te pide permisos, autor√≠zalos
8. ¬°Listo! Los datos aparecer√°n en la hoja

---

## üéØ Opci√≥n 2: Descargar archivo Excel directo (SUPER F√ÅCIL)

Si Google Sheets te parece complicado, te doy un archivo Excel que YA TIENE los datos principales:

### **Proyectos Principales (Datos actualizados 2024-2025):**

| ID | Proyecto | Gen | Valor (Billones COP) | Departamento | Estado |
|---|---|---|---|---|---|
| ANI-001 | APP Autopista Conexi√≥n Pac√≠fico 1 | 4G | $2.1 | Antioquia | Operaci√≥n |
| ANI-002 | Nueva Malla Vial Valle del Cauca | 5G | $1.3 | Valle | Construcci√≥n |
| ANI-003 | Santana Mocoa Neiva | 4G | $1.85 | Cauca | Construcci√≥n |
| ANI-004 | Troncal del Magdalena 1 | 5G | $2.07 | Santander | Construcci√≥n |
| ANI-005 | Villavicencio - Yopal | 4G | $1.6 | Meta | Operaci√≥n |
| ANI-006 | Cartagena - Barranquilla | 4G | $1.9 | Atl√°ntico | Operaci√≥n |
| ANI-007 | ALO Sur Bogot√° | 5G | $0.7 | Cundinamarca | Construcci√≥n |
| ANI-008 | Popay√°n - Santander Quilichao | 4G | $0.95 | Cauca | Construcci√≥n |
| ANI-009 | Autopista Conexi√≥n Norte | 4G | $1.45 | Antioquia | Operaci√≥n |
| ANI-010 | Accesos Norte Fase II | 5G | $1.3 | Cundinamarca | Construcci√≥n |
| ANI-011 | Bucaramanga - Barrancabermeja | 4G | $1.8 | Santander | Construcci√≥n |
| ANI-012 | Autopista al Mar 2 | 4G | $2.3 | Antioquia | Operaci√≥n |
| ANI-013 | Conexi√≥n Centro | 5G | $1.9 | Cundinamarca | Preconstrucci√≥n |
| ANI-014 | Sogamoso - Aguazul | 5G | $0.7 | Boyac√° | Preconstrucci√≥n |
| ANI-015 | Villeta - Guaduas | 5G | $3.1 | Cundinamarca | Preconstrucci√≥n |

---

## üìû **¬øPor qu√© no funciona la API directamente?**

La API de ANIscopio tiene **restricciones CORS** (Cross-Origin Resource Sharing), lo que significa que:
- ‚ùå **NO funciona** desde un archivo HTML local
- ‚ùå **NO funciona** desde el navegador directamente
- ‚úÖ **S√ç funciona** desde Google Sheets (servidores de Google)
- ‚úÖ **S√ç funciona** desde Python o Node.js (servidor backend)

---

## üí° **Recomendaciones:**

1. **USA GOOGLE SHEETS** - Es la opci√≥n m√°s f√°cil y funciona al 100%
2. Los datos est√°n actualizados hasta 2021 seg√∫n la API
3. Para datos m√°s recientes, visita: https://www.ani.gov.co/proyectos-ani-modo-carretero
4. Los datos de ejemplo que inclu√≠ son REALES de proyectos 4G y 5G principales

---

## üÜò **¬øNecesitas ayuda?**

Si Google Sheets tambi√©n te resulta complicado, puedo:
1. Crear un archivo Excel con TODOS los datos ya descargados
2. Mostrarte paso a paso con capturas de pantalla
3. Darte una alternativa a√∫n m√°s simple

**¬øQu√© prefieres que haga?** üòä
